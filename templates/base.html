<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>{% block title %}ChatBase{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  {% block head %}{% endblock %}
  <style>
    /* ƒêi·ªÅu ch·ªânh v·ªã tr√≠ toast container */
    .toast-container {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 2000;
    }

    .message.you {
      justify-content: flex-end;
    }

    .message-content {
      max-width: 75%;
      word-wrap: break-word;
    }
  </style>
</head>

<script type="module">
  import { EmojiButton } from 'https://cdn.jsdelivr.net/npm/@joeattardi/emoji-button@4.6.4/+esm';

  const picker = new EmojiButton({
    position: 'top-start',
    autoHide: true,
  });

  const emojiBtn = document.querySelector('#emoji-btn');
  const input = document.querySelector('#message-input');

  emojiBtn?.addEventListener('click', () => {
    picker.togglePicker(emojiBtn);
  });

  picker.on('emoji', emoji => {
    input.value += emoji.emoji;
    input.focus();
  });

</script>
<script src="https://unpkg.com/simple-peer@9.11.1/simplepeer.min.js"></script>

<body>

  <!-- üîî Hi·ªÉn th·ªã flash message d·∫°ng Toast -->
  <div class="toast-container">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div class="toast align-items-center text-bg-{{ category if category != 'message' else 'primary' }} border-0 mb-2"
      role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="4000" data-bs-autohide="true">
      <div class="d-flex">
        <div class="toast-body">
          {{ message }}
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
          aria-label="Close"></button>
      </div>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
  </div>

  <!-- N·ªôi dung ri√™ng t·ª´ng trang -->
  {% block content %}{% endblock %}

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- K√≠ch ho·∫°t t·ª± ƒë·ªông hi·ªán t·∫•t c·∫£ Toast -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const toastElList = [].slice.call(document.querySelectorAll('.toast'))
      toastElList.forEach(function (toastEl) {
        const toast = new bootstrap.Toast(toastEl)
        toast.show()
      })
    })
  </script>

  {% block scripts %}{% endblock %}
</body>

</html>